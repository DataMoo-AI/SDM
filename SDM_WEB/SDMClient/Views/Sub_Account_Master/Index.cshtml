<script src="~/lib/jquery/dist/jquery.min.js" />
<script type="text/jscript">
    BindGrid();
      $(document).ready(function () {



      })

</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
<style>
    .form-inputs {
        padding: 40px;
        flex: 60%;
        display: flex;
        flex-direction: column;
        align-content: center;
        justify-content: center;
        position: relative;
    }

    .form-btn {
        margin: 20px 0px;
        background-color: #f6fe00;
        color: black;
        padding: 10px 40px;
        font-weight: 700;
        border: none;
        cursor: pointer;
    }

    .form-row {
        padding: 10px 0px;
        position: relative;
    }

    .form-row-field {
        color: #000000;
        position: absolute;
        pointer-events: none;
        transition: 0.5s;
        top: 10px;
        margin-left: 2em;
    }

    .form-row-field-input {
        background-color: inherit;
        display: block;
        top: 10px;
        transition: 0.5s;
        margin-left: 1.5em;
    }

        .form-row-field-input:focus ~ label, input:not(:placeholder-shown) ~ label {
            top: -5px;
            font-size: 12px;
            color: #9b91f5;
            font-weight: bold;
        }

    .fileCss {
        top: -11px;
        font-size: 14px;
        color: #000000;
        font-weight: bold;
    }
</style>
<div class="Gridtable">
    <section class="">
        <div class="">
            <div class="Imgcontainer">
                <img class="CommanImage" src="~/Images/28.jpg" />

                <div class="top-rightWhite1">Sub Account Master</div>
            </div>
        </div>
    </section>
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="card" style="width: 100%;">

                    <div class="card-body">
                        <div class="row align-items-center my-0">
                            <div class="col">

                                <h2 class="">
                                </h2>

                            </div>
                            <div class="">

                                <button type="button" class="btn mb-2 btn-outline-primary btm_mnl" onclick="GridShow(2)"><span class="fas fa-plus mr-2" aria-hidden="true"></span>Add</button>

                            </div>
                        </div>
                        <div class="table-responsive" width="100%">
                            <table id="example2" class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>S.No</th>
                                        <th>Short Name</th>
                                        <th>Name</th>
                                        <th>Details</th>
                                        <th>Cost Center</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="bodyData">
                                    <tr>
                                        <td>Trident</td>
                                        <td>
                                            Internet
                                            Explorer 4.0
                                        </td>
                                        <td>Win 95+</td>
                                        <td> 4</td>
                                        <td> 4</td>
                                        <td> 4</td>
                                        <td>X</td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>
</div>


<div class="GridView" style="display:none">

    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="card" style="width: 100%;">

                    <div class="card-body">
                      <div class="row align-items-center my-0">
            <div class="row col-12">
                        <div class="col-2">
                         <img class="" id="back" style="width: 25%;margin-left: 36%; top:5px" onclick="clearAll()" src="~/Images/BackButton.png">
                        
                        </div>
                        <div class="col-8">
                        <h2 class="h3 mb-0 text-center">Sub Account Master - Add</h2>
                        </div>
                        <div class="col-2">
                         <img class="Righttext" id="print" style="width: 123px;top: 32%;left: 55%;display: block;" onclick="printPage(this)" src="~/Images/Print.jpg">
                        
                        </div>
                        </div>


                        </div>
                        <div class="form-inputs">
                            <div class="row">
                            <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <select id="ddlCostCenter" class="form-row-field-input form-control">
                                            <option selected>Select</option>
                                        </select>
                                        <label for="POST-name" class="fileCss form-row-field">Cost Center</label>
                                    </div>
                                </div>

                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpshortname" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Short Name</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpname" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Name</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpdetails" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Details</label>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prplocation" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Location</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpcontactPerson" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Contact Person</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpContacPersonNo" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Contact Person Number</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpothers1" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Others 1</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpothers2" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Others 2</label>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-row form-group">
                                        <input type="text" id="prpothers3" placeholder=" " class="form-row-field-input form-control">
                                        <label for="POST-name" class="form-row-field">Others 3</label>
                                    </div>
                                </div>


                            </div>
                            <div class="text-center mt-5 mb-3">
                                <a href="#" class="btn btn-md btn-primary" id="_btnSubmit" onclick="IUDEmpDetails(1,0)">Submit</a>
                                <a href="#" class="btn btn-md btn-primary" id="back1"   onclick="clearAll()">Back</a>
                            </div>
                        </div>
                        <!--end-->
                    </div>
                </div>

            </div>
        </div>
    </section>
</div>

<script src="~/js/CommonFunction.js"></script>
<script>

        $(document).ready(function () {
      BindGrid();
       GridShow(1);
       BindCostCenter()
     
          $('#Menu_Parameter_master').show();
          $('a.nav-link.Sub_Account_Master').addClass("active");
          $('#Menu_Parameter_master').css({'display':'block'});
        })

    async function BindGrid() {
        var url = '@Url.Action("BindGrid", "Sub_Account_Master")';
        var data = {"CustId":0};
        data = await callController(url, data);
        console.log(data);

        $('h2.h3.mb-0.text-center').text('Sub Account Master - Add');
        Gridappend(data.subAccountResponse);
    }
    async function _View(csId) {
        debugger;
        var url = '@Url.Action("BindGrid", "Parameter_Master")';
        var data = {"CustId":csId};
        data = await callController(url, data);
        console.log(data.subAccountResponse);
        data=data.subAccountResponse;
          $("#print").css({'display':'block'});
    }
    async function GridShow(Flag){
        if(Flag==1){
            $('.Gridtable').show();
            $('.GridView').hide();
              $("#print").css({'display':'none'});
        }
        else{
            $('.Gridtable').hide();
            $('.GridView').show();
           // await BindCostCenter();
        }
    }
    var cCId = 0;
    var type ='';
    async function _Edit(CustId){
        debugger;
          var url = '@Url.Action("BindGrid", "Sub_Account_Master")';
        var data = {"PrpId":CustId};
        data = await callController(url, data);
        GridShow(2);
        type = 'update';
         cCId = CustId;
        $('h2.h3.mb-0.text-center').text('Sub Account Master - Edit');
        $('#ddlCostCenter').find('option').remove().end().append('<option value="0">Select</option>');
        $('#prpshortname').val(data['subAccountResponse'][0].prpShrtName);
        $('#prpname').val(data['subAccountResponse'][0].prpName);
        $('#prpdetails').val(data['subAccountResponse'][0].prpDetails);
        $('#prpcontactPerson').val(data['subAccountResponse'][0].prpContactPerson);
        $('#prpContacPersonNo').val(data['subAccountResponse'][0].prpContactPersonNumber);
        $('#prpdetails').val(data['subAccountResponse'][0].prpDetails);
        await BindCostCenter();
        $('#ddlCostCenter option[value="'+data['subAccountResponse'][0].prpCostCentre+'"]').attr("selected", "selected");
        $('#prplocation').val(data['subAccountResponse'][0].prpLocation);
        $('#prpothers1').val(data['subAccountResponse'][0].prpOthers1);
        $('#prpothers2').val(data['subAccountResponse'][0].prpOthers2);
        $('#prpothers3').val(data['subAccountResponse'][0].prpOthers3);
        $("#prpshortname").prop('disabled', false);
        $("#prpname").prop('disabled', false);
        $("#prpdetails").prop('disabled', false);
        $("#ddlCostCenter").prop('disabled', false);
        $('#prpcontactPerson').prop('disabled', false);
        $('#prpContacPersonNo').prop('disabled', false);
        $("#prplocation").prop('disabled', false);
        $("#prpothers1").prop('disabled', false);
        $("#prpothers2").prop('disabled', false);
        $("#prpothers3").prop('disabled', false);
        $("#_btnSubmit").show();
    }
    async function _Delete(csId){
         var url = '@Url.Action("BindGrid", "Sub_Account_Master")';
        var data = {"PrpId":csId};
        data = await callController(url, data);
        GridShow(2);
        type = 'delete';
        cCId = csId;
        $('h2.h3.mb-0.text-center').text('Sub Account Master - Delete');
       //cCId = data['subAccountResponse'][0].PrpId;
        $('#prpshortname').val('');
        $('#prpname').val('');
        $('#prpdetails').val('');
        $('#ddlCostCenter').find('option').remove().end().append('<option value="0">Select</option>');
        $('#prplocation').val('');
        $('#prpcontactPerson').val('');
        $('#prpContacPersonNo').val('');
        $('#prpothers1').val('');
        $('#prpothers2').val('');
        $('#prpothers3').val('');
        $('#prpshortname').val(data['subAccountResponse'][0].prpShrtName);
        $('#prpname').val(data['subAccountResponse'][0].prpName);
         $('#prpcontactPerson').val(data['subAccountResponse'][0].prpContactPerson);
        $('#prpContacPersonNo').val(data['subAccountResponse'][0].prpContactPersonNumber);
        $('#prpdetails').val(data['subAccountResponse'][0].prpDetails);
        await BindCostCenter();
        $('#ddlCostCenter option[value="'+data['subAccountResponse'][0].prpCostCentre+'"]').attr("selected", "selected");
        $('#prplocation').val(data['subAccountResponse'][0].prpLocation);
        $('#prpothers1').val(data['subAccountResponse'][0].prpOthers1);
        $('#prpothers2').val(data['subAccountResponse'][0].prpOthers2);
        $('#prpothers3').val(data['subAccountResponse'][0].prpOthers3);
        $("#prpshortname").prop('disabled', true);
        $("#prpname").prop('disabled', true);
        $('#prpcontactPerson').prop('disabled', true);
        $('#prpContacPersonNo').prop('disabled', true);
        $("#prpdetails").prop('disabled', true);
        $("#ddlCostCenter").prop('disabled', true);
        $("#prplocation").prop('disabled', true);
        $("#prpothers1").prop('disabled', true);
        $("#prpothers2").prop('disabled', true);
        $("#prpothers3").prop('disabled', true);
        $("#_btnSubmit").show();
    }
    async function _View(csId){
         var url = '@Url.Action("BindGrid", "Sub_Account_Master")';
        var data = {"PrpId":csId};
        data = await callController(url, data);
        GridShow(2);
        type = 'delete';
        
        $('#print').attr("_PrintID",csId);
        $('h2.h3.mb-0.text-center').text('Sub Account Master - View');
       cCId = csId;
         $("#print").css({'display':'block'});
            $('#prpshortname').val('');
        $('#prpname').val('');
        $('#prpdetails').val('');
        $('#ddlCostCenter').find('option').remove().end().append('<option value="0">Select</option>');
        $('#prplocation').val('');
        $('#prpothers1').val('');
        $('#prpcontactPerson').val('');
        $('#prpContacPersonNo').val('');
        $('#prpothers2').val('');
        $('#prpothers3').val('');
        $('#prpshortname').val(data['subAccountResponse'][0].prpShrtName);
        $('#prpname').val(data['subAccountResponse'][0].prpName);
         $('#prpcontactPerson').val(data['subAccountResponse'][0].prpContactPerson);
        $('#prpContacPersonNo').val(data['subAccountResponse'][0].prpContactPersonNumber);
        await BindCostCenter();
        $('#ddlCostCenter option[value="'+data['subAccountResponse'][0].prpCostCentre+'"]').attr("selected", "selected");
        $('#prpdetails').val(data['subAccountResponse'][0].prpDetails);
        $('#prpcostcenter').val(data['subAccountResponse'][0].prpCostCentre);
        $('#prplocation').val(data['subAccountResponse'][0].prpLocation);
        $('#prpothers1').val(data['subAccountResponse'][0].prpOthers1);
        $('#prpothers2').val(data['subAccountResponse'][0].prpOthers2);
        $('#prpothers3').val(data['subAccountResponse'][0].prpOthers3);
        $("#prpshortname").prop('disabled', true);
        $("#prpname").prop('disabled', true);
        $("#prpdetails").prop('disabled', true);
        $("#ddlCostCenter").prop('disabled', true);
        $('#prpcontactPerson').prop('disabled', true);
        $('#prpContacPersonNo').prop('disabled', true);
        $("#prplocation").prop('disabled', true);
        $("#prpothers1").prop('disabled', true);
        $("#prpothers2").prop('disabled', true);
        $("#prpothers3").prop('disabled', true);
        $("#_btnSubmit").hide();
    }
       function printPage(obj) {
    var url = '@Url.Action("SubAccountPDF", "PrintPDF")'; 
    var _id = $(obj).attr("_PrintID");
    window.open(url + "?ID=" + _id);
}
    async function Gridappend(data) {
        debugger;
        var item = '';
        var Arr;
        if (data!=undefined)
        {
        if (data.length > 0) {
            Arr = data;
            for (var i = 0; i < Arr.length; i++)
            {

                var sno=i+1;
                item += '<tr>';
                item += '<td>' + sno+ '</td>';
                item += '<td>' + Arr[i].prpShrtName  + '</td>';
                item += '<td>' + Arr[i].prpName  + '</td>';
                item += '<td>' + Arr[i].prpDetails  + '</td>';
                item += '<td>' + Arr[i].prpCostCentreName  + '</td>';

                item += '  <td>';
                item += ActionsButtons(Arr[i].prpId)
                item += '</td>';
                item += ' </tr>';
            }
            $('#bodyData').html('').append(item);
        } else {
            $('#bodyData').html('').append('<tr><td colspan="10" style="text-align:center">No records found.</td></tr>');
        }
        }
        else {
            $('#bodyData').html('').append('<tr><td colspan="10" style="text-align:center">No records found.</td></tr>');
        }
    }


    function GridView(data){

    }
     async function BindCostCenter()
        {
            var url = '@Url.Action("BindGrid", "Cost_Center_Master")';
            var data = {"CsId":0};
            data = await callController(url, data);
            $.each(data.costCenterResponse, function (res, value) {
                $("#ddlCostCenter").append($("<option></option>").val(value.csId).html(value.csName));
            })
        }
    async function IUDEmpDetails(){
    debugger;
    var costcenter=$("ddlCostCenter").val();
    if(costcenter=="Select") 
    {
      toastr.warning("please enter the costcenter")  

    }
     var Shortname=$('#prpshortname').val();
        if(Shortname==""){
        toastr.warning("Please enter the short name.");
        return false;
        }
         var Name=$('#prpname').val();
        if(Name==""){
        toastr.warning("Please enter the name.");
        return false;
        }
         var Details=$('#prpdetails').val();
        if(Details==""){
        toastr.warning("Please enter the details.");
        return false;
        }
         var location=$('#prplocation').val();
        if(location==""){
        toastr.warning("Please enter the location.");
        return false;
        }
        // var contactPerson=$('#prpcontactPerson').val();
        //if(contactPerson==""){
        //toastr.warning("Please enter the contactPerson.");
        //return false;
        //}
        //  var ContacPersonNo=$('#prpContacPersonNo').val();
        //if(ContacPersonNo==""){
        //toastr.warning("Please enter the ContacPersonNo.");
        //return false;
        //}
        //   var others1=$('#prpothers1').val();
        //if(others1==""){
        //toastr.warning("Please enter the others1.");
        //return false;
        //}
        //  var others2=$('#prpothers2').val();
        //if(others2==""){
        //toastr.warning("Please enter the others2.");
        //return false;
        //}
        // var others3=$('#prpothers3').val();
        //if(others3==""){
        //toastr.warning("Please enter the others3.");
        //return false;
        //}
        var data =
        {
            "prpId":cCId,
            "prpShortName":$('#prpshortname').val(),
            "prpName":$('#prpname').val(),
            "prpDetails": $('#prpdetails').val(),
            "prpCostCentre":$('#ddlCostCenter').val(),
            "prpContactPerson":$('#prpcontactPerson').val(),
            "prpContactPersonNumber":$('#prpContacPersonNo').val(),
            "prpLocation":$('#prplocation').val(),
            "prpOthers1":$('#prpothers1').val(),
            "prpOthers2":$('#prpothers2').val(),
            "prpOthers3":$('#prpothers3').val(),
        };
        if(cCId == 0)
        {
            var url = '@Url.Action("Add", "Sub_Account_Master")';
            data = await callController(url, data);
            toastr.success('Sub account master added.');
        }
        else
        {
            if(type == 'update'){
                var url = '@Url.Action("Update", "Sub_Account_Master")';
                data = await callController(url, data);
                toastr.success('Sub account master updated.');
            }
            else{
                var url = '@Url.Action("Delete", "Sub_Account_Master")';
                data = await callController(url, data);
                toastr.success('Sub account master deleted.');
            }
        }
        console.log(data);
    setTimeout(function() { clearAll() }, 3000);
    }

    function clearAll(){
          GridShow(1);
            $("#print").css({'display':'none'});
           $('input[type=text]').val('');
        $('h2.h3.mb-0.text-center').text('Sub Account Master - Add');
    }
        $('#back').click(function() {
    location.reload();
});

</script>